<!DOCTYPE html>
<html lang="zh-CN,zh-HK,default">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="笔记">
    <meta name="author" content="那该多好">
    
    <title>
        
            vue3笔记 |
        
        Is no tomorrow
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"uihh.cn","root":"/","language":["zh-CN","zh-HK","default"],"path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#00aaff","avatar":"https://raw.githubusercontent.com/dgy20/picX/master/await.pvokncfaes0.webp","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"不要让追求之舟停泊在幻想的港湾，而应扬起奋斗的风帆，驶向现实生活的大海。"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="看什么博客，去看文档啊" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Is no tomorrow
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">vue3笔记</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="https://raw.githubusercontent.com/dgy20/picX/master/await.pvokncfaes0.webp">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">那该多好</span>
                        
                            <span class="author-label">Lv2</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-02-10 08:42:22</span>
        <span class="mobile">2022-02-10 08:42</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Vue/">Vue</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/vue3/">vue3</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <hr>
<span id="more"></span>

<!-- ### 变化
vue3可以没有唯一根节点，默认会在最外层包一层 <fragment></fragment>
vue3移除了 $children -->
<h2 id="composition-API"><a href="#composition-API" class="headerlink" title="composition API"></a>composition API</h2><h3 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h3><p><strong>在<code>setup</code>中应该避免使用this，因为this不指向组件实例</strong></p>
<h4 id="setup函数参数"><a href="#setup函数参数" class="headerlink" title="setup函数参数"></a>setup函数参数</h4><ul>
<li>参数1: props<blockquote>
<p><code>props</code>就是父组件传递过来的属性，会被放到<code>props</code>对象中，如果需要在<code>setup</code>中使用，需要配合<code>props</code>配置项,通过<code>props</code>参数获取</p>
<ul>
<li>定义props的类型，还是在props配置项中定义</li>
<li>且在template中依然是可以正常去使用props中的属性</li>
<li>在setup函数中想要使用props，不可以通过 this 去获取，直接通过参数使用即可</li>
</ul>
</blockquote>
</li>
<li>参数2: context<blockquote>
<p><code>context</code>包含三个属性</p>
<ul>
<li><code>attrs</code>：所有未在props中接收的属性</li>
<li><code>slots</code>：父组件传递过来的插槽</li>
<li><code>emit</code>：调用父组件方法时用到的emit</li>
</ul>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">String</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params">props, &#123; attrs, slots, emit &#125;</span>)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="setup函数的返回值"><a href="#setup函数的返回值" class="headerlink" title="setup函数的返回值"></a>setup函数的返回值</h4><ul>
<li>setup的返回值可以在<font color='red'>模板template中被使用</font>,也就是说我们可以<font color=red>通过setup的返回值来替代data选项</font></li>
<li>可以<font color=red>返回一个执行函数来代替在methods中定义的方法</font></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>name: &#123;&#123;name&#125;&#125;, age: &#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;increment&quot;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;decrement&quot;</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> name = <span class="string">&#x27;TT&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> age = <span class="number">18</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">const</span> increment = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        age++</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">const</span> decrement = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        age--</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        name,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        age,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        increment,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        decrement</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="setup不可以使用this"><a href="#setup不可以使用this" class="headerlink" title="setup不可以使用this"></a>setup不可以使用this</h4><ul>
<li>表达的含义是this并没有指向当前组件实例</li>
<li>并且在setup被调用之前，data、computed、methods等都没有被解析</li>
<li>所以无法在setup中获取this</li>
</ul>
<h4 id="setup中使用ref"><a href="#setup中使用ref" class="headerlink" title="setup中使用ref"></a>setup中使用ref</h4><ul>
<li>只需要定义一个ref对象，绑定到元素或者组件的ref属性上即可</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2 ref=&quot;titleRef&quot;&gt;我是标题&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">  export default &#123;</span><br><span class="line">    const titleRef = ref(null) // 先用null占位</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      titleRef</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Reactive-API"><a href="#Reactive-API" class="headerlink" title="Reactive API"></a>Reactive API</h3><ul>
<li>如果想为在setup中定义的数据提供响应式的特性，那么我们可以使用reactive的函数<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> state = reactive(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;TT&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>原因<ul>
<li>这是因为当我们<font color=red>使用reactive函数处理我们的数据之后</font>，数据<font color=red>再次被使用</font>时就会进行<font color=red>依赖收集</font></li>
<li>当<font color=red>数据发生改变</font>时，所有<font color=red>收集到的依赖</font>都是<font color=red>进行对应的响应式操作</font>（比如更新界面）</li>
<li>事实上，我们编写的<font color=red>data选项</font>，也是在内部交给了 <strong>reactive函数</strong> 将其编成响应式对象的</li>
</ul>
</li>
<li>限制<ul>
<li><code>reactive</code>要求我们必须传入的是一个对象或数组类型，如果传入 <strong>基本数据类型(String, Number, Boolean)会报一个警告</strong>:<br> **<font style="background: #f2be45" color=red>value cannot be made reactive: ***</font>**</li>
</ul>
</li>
</ul>
<h3 id="Ref-API"><a href="#Ref-API" class="headerlink" title="Ref API"></a>Ref API</h3><ul>
<li>ref 会返回一个<font color=red>可变的响应式对象</font>， 该对象作为一个 <strong><font color=red>响应式的引用</font></strong> 维护着它内部的值，这就是ref名称的来源</li>
<li>它内部的值是在ref的value 属性中被维护的<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> message = ref(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(message.value)  -&gt; <span class="string">&#x27;Hello World&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>注意事项：<ul>
<li>在<strong>模板中引入ref的值</strong>时，Vue会<strong>自动帮助我们进行解包</strong>操作，所以我们并<font color=red>不需要在模板中通过ref.value</font>的方式来使用</li>
<li>但是在<strong>setup 函数内部</strong>，它依然是一个<strong>ref引用</strong>，所以对其进行操作时，我们依然<font color=red>需要使用ref.value</font>的方式</li>
</ul>
</li>
</ul>
<p><strong>ref自动解包</strong></p>
<ul>
<li>模板中的解包是浅层解包，如果把ref对象放到一个普通对象内部，在模板中使用时将不会自动解包<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span> &#123;&#123; message &#125;&#125; <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span> &#123;&#123; info.message.value &#125;&#125; <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> message = ref(<span class="string">&#x27;Hello World&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> info = &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        message</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        message,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        info</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>
<li>如果我们将ref放到一个reactive的属性当中，那么在模板中使用时，它会自动解包<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span> &#123;&#123; message &#125;&#125; <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span> &#123;&#123; info.message &#125;&#125; <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">import</span> &#123; ref, reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> message = ref(<span class="string">&#x27;Hello World&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> info = reactive(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        message</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        message,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        info</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a>readonly</h3><ul>
<li>何时使用？<ul>
<li>通过<code>reactive</code>或者<code>ref</code>可以获取到一个响应式对象，但如果希望传递给某些组件使用，并且不允许修改时</li>
</ul>
</li>
<li><code>readonly</code>会返回原生对象的只读代理（也就是它依然是一个Proxy，这是一个proxy的set方法被劫持，并且不 能对其进行修改）</li>
<li>在开发中常见的<code>readonly</code>方法会传入三个类型的参数<ul>
<li>类型一：普通对象</li>
<li>类型二：<code>reactive</code>返回的对象</li>
<li>类型三：<code>ref</code>的对象</li>
</ul>
</li>
<li><code>readonly</code>的使用<ul>
<li><code>readonly</code>返回的对象都是不允许修改的</li>
<li>经过<code>readonly</code>处理的原来的对象允许修改，当原对象改变时，<code>readonly</code>返回的对象也会被修改</li>
<li>本质上就是<code>readonly</code>返回的对象的<code>setter</code>方法被劫持了而已</li>
</ul>
</li>
</ul>
<h3 id="Reactive判断的API"><a href="#Reactive判断的API" class="headerlink" title="Reactive判断的API"></a>Reactive判断的API</h3><ul>
<li><strong>isProxy</strong><ul>
<li>检查对象<font color=red>是否是由reactive 或readonly创建的proxy</font></li>
</ul>
</li>
<li><strong>isReactive</strong><ul>
<li>检查对象是否<font color=red>是由reactive创建的响应式代理</font></li>
<li>如果<font color=red>该代理是readonly创建的</font>，<font color=red>但包裹了由reactive 创建的另一个代理</font>，它也会返回true</li>
</ul>
</li>
<li><strong>isReadonly</strong><ul>
<li>检查对象是否是由readonly创建的只读代理<font color=red></font></li>
</ul>
</li>
<li><strong>toRaw</strong><ul>
<li>返回<font color=red>reactive 或readonly代理的原始对象</font>（不建议保留对原始对象的持久引用。请谨慎使用）</li>
</ul>
</li>
<li><strong>shallowReactive</strong><ul>
<li>创建一个响应式代理，它跟踪其自身property 的响应性，但<font color=red>不执行嵌套对象的深层响应式转换</font>(深层还是原生对象)</li>
</ul>
</li>
<li><strong>shallowReadonly</strong><ul>
<li>创建一个proxy，使其自身的property 为只读，但<font color=red>不执行嵌套对象的深度只读转换</font>（深层还是可读、可写的）</li>
</ul>
</li>
</ul>
<h3 id="toRefs"><a href="#toRefs" class="headerlink" title="toRefs"></a>toRefs</h3><ul>
<li>如果我们使用<strong>ES6的解构语法</strong>，对<strong>reactive返回的对象进行解构获取值</strong>，那么之后无论是<strong>修改解构后的变量</strong>，还是<strong>修改reactive返回的state对象</strong>， <strong><font color=red>数据都不再是响应式的</font></strong><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> info = reactive(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;TT&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; name, age &#125; = info</span><br></pre></td></tr></table></figure></li>
<li>解决办法<ul>
<li>Vue为我们提供了一个<font color=red>toRefs的函数</font>，可以将<font color=red>reactive返回的对象中的属性都转成ref</font></li>
<li>那么我们再次进行解构出来的<font color=red>name 和age 本身都是ref的</font><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当我们这样写的时候，会返回两个ref对象，他们都是响应式的</span></span><br><span class="line"><span class="keyword">let</span> &#123; name, age &#125; = toRefs(info)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>这种做法相当于已经在<strong>info.name和ref.value之间建立了链接，任何一个修改都会引起另外一个变化</strong></li>
</ul>
<h3 id="toRef"><a href="#toRef" class="headerlink" title="toRef"></a>toRef</h3><ul>
<li>如果只希望转换一个<strong>reactive对象中的属性为ref</strong>, 那么可以使用<strong>toRef方法</strong><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = toRef(info, <span class="string">&#x27;name&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> changeName = <span class="function">() =&gt;</span> info.name = <span class="string">&#x27;zs&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="ref的其他API"><a href="#ref的其他API" class="headerlink" title="ref的其他API"></a>ref的其他API</h3><ul>
<li>unref<ul>
<li>如果我们想要获取一个ref引用中的value，可以通过unref方法</li>
<li><font color=red>如果参数是一个ref，则返回内部值，否则返回参数本身</font></li>
<li>这是<font color=red>val= isRef(val) ? val.value: val</font>的语法糖函数</li>
</ul>
</li>
<li>isRef<ul>
<li>判断值是否是一个ref对象</li>
</ul>
</li>
<li>shallowRef<ul>
<li>创建一个浅层的ref对象</li>
</ul>
</li>
<li>triggerRef<ul>
<li>手动触发和shallowRef相关联的副作用<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> info = shallowRef(&#123; <span class="attr">name</span>: <span class="string">&#x27;tt&#x27;</span> &#125;)</span><br><span class="line"><span class="comment">// 下面的修改不是响应式的</span></span><br><span class="line"><span class="keyword">const</span> changeInfo = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  info.value.name = <span class="string">&#x27;zs&#x27;</span></span><br><span class="line">  <span class="comment">// 手动触发</span></span><br><span class="line">  triggerRef(info)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="customRef"><a href="#customRef" class="headerlink" title="customRef"></a>customRef</h3><ul>
<li>创建一个 <strong>自定义的ref，并对其依赖项跟踪和更新触发进行显式控制</strong><ul>
<li>它需要一个工厂函数，该函数<font color=red>接收track 和trigger 函数</font>作为参数</li>
<li>并且应该<font color=red>返回一个带有get 和set 的对象</font></li>
</ul>
</li>
<li>对双向绑定属性进行debounce(节流)的案例:<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; customRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">useDebouncedRef</span>(<span class="params">value, delay = <span class="number">200</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timeout;</span><br><span class="line">  <span class="keyword">return</span> customRef( <span class="function">(<span class="params">track, trigger</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="function"><span class="title">get</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        track();</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function"><span class="title">set</span>(<span class="params">newValue</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">        timeout = <span class="built_in">setTimeout</span>( <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          value = newValue;</span><br><span class="line">          trigger()</span><br><span class="line">        &#125;, delay)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<strong>使用方式</strong><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;msg&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span> &#123;&#123;msg&#125;&#125; <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">import</span> &#123; useDebouncedRef &#125; <span class="keyword">from</span> <span class="string">&#x27;@/hooks/useDebounceRef&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> msg = useDebouncedRef(<span class="string">&#x27;Hello World&#x27;</span>)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        msg</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="computed"><a href="#computed" class="headerlink" title="computed"></a>computed</h3><ul>
<li>当我们的某些属性是依赖其他状态时，可以使用计算属性来处理<ul>
<li>在前面的Options API中，我们是使用computed选项来完成的</li>
<li>在Composition API中，我们可以在setup 函数中使用computed 方法来编写一个计算属性</li>
</ul>
</li>
<li>用法<ul>
<li>方式一：接收一个getter函数，并为getter函数返回的值，返回一个不变的ref 对象<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> fullName = computed( <span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> firstName.value + <span class="string">&#x27; &#x27;</span> + lastName.value</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>方式二：接收一个具有get和set的对象，返回一个可变的（可读写）的ref对象<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fullName = computed(&#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> firstName.value + <span class="string">&#x27; &#x27;</span> + lastName.value</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">set</span>: <span class="function"><span class="params">newValue</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> names = newValue.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">    firstName.value = names[<span class="number">0</span>];</span><br><span class="line">    lastName.value = names[<span class="number">1</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="侦听数据的变化"><a href="#侦听数据的变化" class="headerlink" title="侦听数据的变化"></a>侦听数据的变化</h3><ul>
<li>在前面的Options API中，我们可以通过watch选项来侦听data或者props的数据变化，当数据变化时执行某一些操作</li>
<li>在Composition API中，我们可以使用watchEffect和watch来完成响应式数据的侦听<ul>
<li>watchEffect用于自动收集响应式数据的依赖</li>
<li>watch需要手动指定侦听的数据源</li>
</ul>
</li>
</ul>
<h4 id="watchEffect"><a href="#watchEffect" class="headerlink" title="watchEffect"></a>watchEffect</h4><h5 id="watchEffect用法"><a href="#watchEffect用法" class="headerlink" title="watchEffect用法"></a>watchEffect用法</h5><ul>
<li>当侦听到某些响应式数据变化时，我们希望执行某些操作，这个时候可以使用watchEffect</li>
<li>看一个案例<ul>
<li>首先，watchEffect传入的函数会被立即执行一次，并且在执行的过程中会收集依赖</li>
<li>其次，只有收集的依赖发生变化时，watchEffect传入的函数才会再次执行<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = ref(<span class="string">&#x27;tt&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> age = ref(<span class="number">18</span>);</span><br><span class="line"></span><br><span class="line">watchEffect( <span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;watchEffect执行&#x27;</span>, name.value, age.value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h5 id="watchEffect的停止侦听"><a href="#watchEffect的停止侦听" class="headerlink" title="watchEffect的停止侦听"></a>watchEffect的停止侦听</h5><ul>
<li>如果在发生某些情况下，我们希望停止侦听，这个时候我们可以获取watchEffect的返回值函数，调用该函数即可</li>
<li>比如在上面的案例中，我们age达到20的时候就停止侦听<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> stopWatch = watchEffect( <span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;watchEffect执行&#x27;</span>, name.value, age.value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> changeAge = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  age.value++</span><br><span class="line">  <span class="keyword">if</span>(age.value &gt; <span class="number">20</span>)&#123;</span><br><span class="line">    stopWacth()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="watchEffect清除副作用"><a href="#watchEffect清除副作用" class="headerlink" title="watchEffect清除副作用"></a>watchEffect清除副作用</h5><ul>
<li>什么是清除副作用呢？<ul>
<li>比如在开发中我们需要在侦听函数中执行网络请求，但是在网络请求还没有达到的时候，我们停止了侦听器，或者侦听器侦听函数被再次执行了</li>
<li>那么上一次的网络请求应该被取消掉，这个时候我们就可以清除上一次的副作用</li>
</ul>
</li>
<li>在我们给watchEffect传入的函数被回调时，其实可以获取到一个参数：onInvalidate<ul>
<li>当<strong>副作用即将重新执行</strong>或者<strong>侦听器被停止时</strong>会执行该函数传入的回调函数</li>
<li>我们可以在传入的回调函数中，执行一些清除工作<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> stopWatch = watchEffect( <span class="function">(<span class="params">onInValidate</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;watchEffect执行&#x27;</span>, name.value, age.value)</span><br><span class="line">  <span class="keyword">const</span> timer = <span class="built_in">setTimeout</span>( <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;2s后执行的操作&#x27;</span>)</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">  onInvalidate( <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h5 id="watchEffect的执行时机"><a href="#watchEffect的执行时机" class="headerlink" title="watchEffect的执行时机"></a>watchEffect的执行时机</h5><ul>
<li>默认情况下，组件的更新会在副作用函数执行之前<ul>
<li>能不能在副作用函数中获取到元素呢？<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> titleRef = ref(<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">const</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    watchEffect( <span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(titleRef.value)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      titleRef,</span><br><span class="line">      count</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * log:</span></span><br><span class="line"><span class="comment"> * &gt; null</span></span><br><span class="line"><span class="comment"> * &gt; &lt;h2&gt;&lt;/h2&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>我们会发现打印结果打印了两次<ul>
<li>这是因为setup函数在执行时就会立即执行传入的副作用函数，这个时候DOM并没有挂载，所以打印为null</li>
<li>而当DOM挂载时，会给title的ref对象赋值新的值，副作用函数会再次执行，打印出来对应的元素</li>
</ul>
</li>
</ul>
<h5 id="调整watchEffect的执行时机"><a href="#调整watchEffect的执行时机" class="headerlink" title="调整watchEffect的执行时机"></a>调整watchEffect的执行时机</h5><ul>
<li>如果我们希望第一次执行时就能打印出对应的元素<ul>
<li>这个时候我们需要改变副作用函数的执行时机</li>
<li>它的默认值是pre，它会在元素挂载或者更新之前执行</li>
<li>所以我们会先打印出来一个空的，当依赖的title发生改变时，就会再次执行一次，打印出元素</li>
</ul>
</li>
<li>设置副作用函数的执行时机</li>
<li><code>watchEffect</code>的第二个参数<code>&#123; flush: &#39;&#39; &#125;</code></li>
<li><code>flush</code>可选值：<code>pre</code>、<code>post</code>，<code>sync</code><ul>
<li><code>pre</code>：默认。挂载前、更新前</li>
<li><code>post</code>：将推迟副作用函数的初始运行，直到组件的首次渲染完成才会执行</li>
<li><code>sync</code>：将强制效果始终同步触发。然而，这是低效的，应该很少需要<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> h2ElContent = <span class="literal">null</span>;</span><br><span class="line">watchEffect( <span class="function">()=&gt;</span>&#123;</span><br><span class="line">  h2ElContent = titleRef.value &amp;&amp; titleRef.value.textContent</span><br><span class="line">  <span class="built_in">console</span>.log(h2ElContent, count.value)</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">flush</span>: <span class="string">&#x27;post&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h4><h5 id="watch的使用"><a href="#watch的使用" class="headerlink" title="watch的使用"></a>watch的使用</h5><ul>
<li>watch的API完全等同于组件watch选项的Property：<ul>
<li>watch需要侦听特定的数据源，并在回调函数中执行副作用</li>
<li>默认情况下它是惰性的，只有当被侦听的源发生变化时才会执行回调</li>
</ul>
</li>
<li>与watchEffect的比较，watch允许我们<ul>
<li>懒执行副作用(第一次不会直接执行)</li>
<li>更具体的说明当哪些状态发生变化时，触发侦听器的执行</li>
<li>访问侦听状态变化前后的值</li>
</ul>
</li>
</ul>
<h5 id="侦听单个数据源"><a href="#侦听单个数据源" class="headerlink" title="侦听单个数据源"></a>侦听单个数据源</h5><ul>
<li><p>watch侦听的数据源有两种类型：</p>
<ul>
<li>一个getter函数： 但是该getter函数必须引用可响应式的对象（ref或reactive）<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> info = reactive(&#123;<span class="attr">name</span>: <span class="string">&#x27;TT&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span>&#125;)</span><br><span class="line">watch( <span class="function">() =&gt;</span> info.name, <span class="function">(<span class="params">newVal, oldVal</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new:&#x27;</span>, newVal, <span class="string">&#x27;old:&#x27;</span>, oldVal);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>侦听响应式对象，<code>reactive</code>或者<code>ref</code>(比较常用的是ref)<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 情况一： reactive对象获取到的newValue和oldValue本身都是 reactive对象</span></span><br><span class="line">watch(info, <span class="function">(<span class="params">newVal, oldVal</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new:&#x27;</span>, newVal, <span class="string">&#x27;old:&#x27;</span>, oldVal);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<img src="https://raw.githubusercontent.com/dgy20/picX/master/watch%E4%BC%A0%E5%85%A5reactive%E5%AF%B9%E8%B1%A1.jpg" alt="image text"></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果希望newValue和oldValue是一个普通的对象,可以使用扩展运算符</span></span><br><span class="line">watch(<span class="function">()=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;...info&#125;</span><br><span class="line">&#125;, <span class="function">(<span class="params">newVal, oldVal</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new:&#x27;</span>, newVal, <span class="string">&#x27;old:&#x27;</span>, oldVal);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="侦听多个数据源"><a href="#侦听多个数据源" class="headerlink" title="侦听多个数据源"></a>侦听多个数据源</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = ref(<span class="string">&#x27;TT&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> age = ref(<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> changeName = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    name.value = <span class="string">&#x27;zs&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">//     数组写法        使用多个数组接收新旧值</span></span><br><span class="line">watch([info, name], <span class="function">(<span class="params">[newInfo, newName], [oldInfo, oldName]</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new:&#x27;</span>, newInfo, <span class="string">&#x27;old:&#x27;</span>, oldInfo);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new:&#x27;</span>, newName, <span class="string">&#x27;old:&#x27;</span>, oldName);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="侦听响应式对象"><a href="#侦听响应式对象" class="headerlink" title="侦听响应式对象"></a>侦听响应式对象</h5><blockquote>
<p>监听到的对象为reactive对象<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">watch(info, <span class="function">(<span class="params">newInfo, oldInfo</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new:&#x27;</span>, newInfo, <span class="string">&#x27;old:&#x27;</span>, oldInfo);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br>如果希望监听到的对象或数组为普通对象，可以使用一个getter函数，并且对可响应对象进行解构<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = active([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">watch(<span class="function">()=&gt;</span>([...arr]), <span class="function">(<span class="params">newArr, oldArr</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new:&#x27;</span>, newArr, <span class="string">&#x27;old:&#x27;</span>, oldArr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h5 id="watch的选项"><a href="#watch的选项" class="headerlink" title="watch的选项"></a>watch的选项</h5><ul>
<li>如果想进行深层侦听，需要在<code>watch</code>的第三个对象参数设置<strong>deep为true</strong></li>
<li>如果想立即执行一次<code>watch</code>，也可以传入<code>immediate</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> info = reactive(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;TT&#x27;</span>, </span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">friend</span>: &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;ls&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//        需要用小括号包裹</span></span><br><span class="line">watch( <span class="function">()=&gt;</span>(&#123;...info&#125;) , <span class="function">(<span class="params">newInfo, oldInfo</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;new:&#x27;</span>, newInfo, <span class="string">&#x27;old:&#x27;</span>, oldInfo);</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    <span class="attr">deep</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">immediate</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> changeData = <span class="function">() =&gt;</span>&#123;</span><br><span class="line">    info.name = <span class="string">&#x27;zs&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="生命周期钩子"><a href="#生命周期钩子" class="headerlink" title="生命周期钩子"></a>生命周期钩子</h3><blockquote>
<p>使用直接导入的 onXXX 函数注册生命周期钩子，这些函数接受一个回调函数，当钩子被组件调用时将会被执行</p>
</blockquote>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; onMounted, onUpdated, onUnmounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    onMounted(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;App onMounted&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    onUpdated( <span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;App onUpdated&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    onUnmounted( <span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;App onUnmounted&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">选项式API</th>
<th align="center">Hook inside <code>setup</code></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>beforeCreate</code></td>
<td align="center">Not needed*</td>
</tr>
<tr>
<td align="center"><code>created</code></td>
<td align="center">Not needed*</td>
</tr>
<tr>
<td align="center"><code>beforeMount</code></td>
<td align="center"><code>onBeforeMount</code></td>
</tr>
<tr>
<td align="center"><code>mounted</code></td>
<td align="center"><code>onMounted</code></td>
</tr>
<tr>
<td align="center"><code>beforeUpdate</code></td>
<td align="center"><code>onBeforeUpdate</code></td>
</tr>
<tr>
<td align="center"><code>updated</code></td>
<td align="center"><code>onUpdated</code></td>
</tr>
<tr>
<td align="center"><code>beforeDestroy</code></td>
<td align="center"><code>onBeforeUnmount</code></td>
</tr>
<tr>
<td align="center"><code>destroyed</code></td>
<td align="center"><code>onUnmounted</code></td>
</tr>
<tr>
<td align="center"><code>activated</code></td>
<td align="center"><code>onActivated</code></td>
</tr>
<tr>
<td align="center"><code>deactivated</code></td>
<td align="center"><code>onDeactivated</code></td>
</tr>
</tbody></table>
<blockquote>
<p>TIP<br>因为 <code>setup</code> 是围绕 <code>beforeCreate</code> 和 <code>created</code> 生命周期钩子运行的，所以不需要显式地定义它们。换句话说，在这些钩子中编写的任何代码都应该直接在 <code>setup</code> 函数中编写。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">created</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    axios.get(<span class="string">&#x27;/api/***&#x27;</span>).then()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 改为直接写在setup 函数内</span></span><br><span class="line"><span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    axios.get(<span class="string">&#x27;/api/***&#x27;</span>).then()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="hook的使用"><a href="#hook的使用" class="headerlink" title="hook的使用"></a>hook的使用</h3><p><strong>实现一个监听界面滚动位置的Hook</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> scrollX = ref(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">let</span> scrollY = ref(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">document</span>.addEventListener(<span class="string">&#x27;scroll&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    scrollX.value = <span class="built_in">window</span>.scrollX</span><br><span class="line">    scrollY.value = <span class="built_in">window</span>.scrollY</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> &#123; scrollX, scrollY &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>实现一个使用localStorage存储和获取数据的Hook</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, watch &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">key, value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> data = ref(value);</span><br><span class="line">  <span class="comment">// 如果传入了value， 就把key 和 value 存起来</span></span><br><span class="line">  <span class="comment">// 否则就去localStorage里找key对应的值</span></span><br><span class="line">  <span class="keyword">if</span>(value)&#123;</span><br><span class="line">    <span class="built_in">window</span>.localStorage.setItem(key, <span class="built_in">JSON</span>.stringify(value))</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    data.value = <span class="built_in">JSON</span>.parse(<span class="built_in">window</span>.localStorage.getItem(key))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果data的值发生了改变，要把localStorage内对应的值也修改</span></span><br><span class="line">  watch( data, <span class="function">(<span class="params">newValue</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.localStorage.setItem(key, <span class="built_in">JSON</span>.stringify(newValue))</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> data</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>用法</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useScrollPosition, useLocalstorage &#125; <span class="keyword">from</span> <span class="string">&#x27;./hooks&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// scoll</span></span><br><span class="line">    <span class="keyword">let</span> &#123;scrollX, scrollY&#125; = useScrollPosition()</span><br><span class="line">    <span class="comment">// localstorage</span></span><br><span class="line">    <span class="keyword">let</span> data = useLocalstorage(<span class="string">&#x27;info&#x27;</span>, &#123; <span class="attr">name</span>: <span class="string">&#x27;TT&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;)</span><br><span class="line">    <span class="keyword">const</span> changeData = <span class="function">() =&gt;</span> data.value = <span class="string">&#x27;hello world&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// ...useScrollPosition()</span></span><br><span class="line">      scrollX,</span><br><span class="line">      scrollY,</span><br><span class="line">      data,</span><br><span class="line">      changeData</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="单文件组件-lt-script-setup-gt"><a href="#单文件组件-lt-script-setup-gt" class="headerlink" title="单文件组件&lt;script setup&gt;"></a>单文件组件<code>&lt;script setup&gt;</code></h3><h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><blockquote>
<p>里面的代码会被编译成组件 <code>setup()</code> 函数的内容。这意味着与普通的 <code>&lt;script&gt;</code> 只在组件被首次引入的时候执行一次不同，<code>&lt;script setup&gt;</code> 中的代码会在每次组件实例被创建的时候执行。<code>import</code>引入的内容也可以直接在模板中使用</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123;&#123; name &#125;&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">import</span> name <span class="keyword">from</span> <span class="string">&#x27;./name.js&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="built_in">console</span>.log(<span class="string">&#x27;hello script setup&#x27;</span>)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="响应式"><a href="#响应式" class="headerlink" title="响应式"></a>响应式</h4><blockquote>
<p>响应式状态需要明确使用<strong>响应式 APIs</strong> 来创建。和从 <code>setup()</code> 函数中返回值一样，ref 值在模板中使用的时候会自动解包</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;当前计数: &#123;&#123; count &#125;&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button @click=&quot;count++&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 如果需要给组件定义name，可以单独写一个script标签,如果不定义，会自动将组件文件名称作为组件名 --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#x27;App&#x27;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">    import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">    const count = ref(0)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="使用组件"><a href="#使用组件" class="headerlink" title="使用组件"></a>使用组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;HelloWorld&gt;&lt;/HelloWorld&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">    // 组件写法-&gt; 不用注册，&lt;script setup&gt; 范围里的值能被直接作为自定义组件的标签名使用</span><br><span class="line">    import HelloWorld from &#x27;./HelloWorld.vue&#x27;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h4><blockquote>
<p>由于组件被引用为变量而不是作为字符串键来注册的，在 <code>&lt;script setup&gt;</code> 中要使用动态组件的时候，应该使用动态的 <code>:is</code> 来绑定</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;component :is=&quot;Foo&quot; /&gt;</span><br><span class="line">  &lt;component :is=&quot;someCondition ? Foo : Bar&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">  import Foo from &#x27;./Foo.vue&#x27;</span><br><span class="line">  import Bar from &#x27;./Bar.vue&#x27;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="defineProps-和-defineEmits"><a href="#defineProps-和-defineEmits" class="headerlink" title="defineProps 和 defineEmits"></a><code>defineProps</code> 和 <code>defineEmits</code></h4><blockquote>
<p>在 <code>&lt;script setup&gt;</code> 中必须使用 <code>defineProps</code> 和 <code>defineEmits</code> API 来声明 <code>props</code> 和 <code>emits</code></p>
</blockquote>
<p><strong>父组件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">HelloWorld</span> <span class="attr">message</span>=<span class="string">&quot;呵呵呵&quot;</span> @<span class="attr">getCount</span>=<span class="string">&quot;getCount&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">HelloWorld</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">import</span> HelloWorld <span class="keyword">from</span> <span class="string">&#x27;./HelloWorld.vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">const</span> getCount = <span class="function"><span class="params">count</span> =&gt;</span> <span class="built_in">console</span>.log(count);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p><strong>子组件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;emitEvent&quot;</span>&gt;</span>发射事件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> props = defineProps(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">message</span>: &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">type</span>: <span class="built_in">String</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">defaults</span>: <span class="string">&#x27;hahah&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> emits = defineEmits([<span class="string">&#x27;getCount&#x27;</span>])</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> emitEvent = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    emits(<span class="string">&#x27;getCount&#x27;</span>, <span class="number">100</span>)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="h函数"><a href="#h函数" class="headerlink" title="h函数"></a>h函数</h4><blockquote>
<p>h() 函数是一个用于创建 vnode 的一个函数，需要从vue导入</p>
</blockquote>
<ul>
<li>h( tag[, props, children] )<ul>
<li><code>tag</code> ： 必需 ,参数类型{ String | Object | Function }，HTML标签名、组件、函数式组件</li>
<li><code>props</code>:  可选，参数类型{ object }，给元素绑定事件或元素</li>
<li><code>children</code>： 可选，参数类型{ string | array | object }, 子VNode，使用<code>h()</code>构建，可直接传递字符串或者有插槽的对象</li>
</ul>
</li>
</ul>
<h5 id="基本用法-1"><a href="#基本用法-1" class="headerlink" title="基本用法"></a>基本用法</h5><blockquote>
<p>h函数可以在两个地方使用:</p>
</blockquote>
<ul>
<li><code>render</code>函数选项中;</li>
<li><code>setup</code>函数选项中（setup本身需要是一个函数类型，函数再返回h函数创建的VNode<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, h &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// —————————————————————data、setup 都可使用——————————————————————</span></span><br><span class="line">    <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> count = ref(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            count</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> h(<span class="string">&#x27;div&#x27;</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;app&#x27;</span> &#125;, [</span><br><span class="line">            h(<span class="string">&#x27;h2&#x27;</span>, <span class="literal">null</span>, <span class="string">`当前计数：<span class="subst">$&#123;<span class="built_in">this</span>.count&#125;</span>`</span>),</span><br><span class="line">            h(<span class="string">&#x27;button&#x27;</span>, &#123;</span><br><span class="line">                <span class="attr">onClick</span>: <span class="function">() =&gt;</span> <span class="built_in">this</span>.count ++</span><br><span class="line">            &#125;, <span class="string">&#x27;+1&#x27;</span>),</span><br><span class="line">            h(<span class="string">&#x27;button&#x27;</span>, &#123;</span><br><span class="line">                <span class="attr">onClick</span>: <span class="function">() =&gt;</span> <span class="built_in">this</span>.count --</span><br><span class="line">            &#125;, <span class="string">&#x27;-1&#x27;</span>)</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="在setup中使用render"><a href="#在setup中使用render" class="headerlink" title="在setup中使用render"></a>在setup中使用render</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, h &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	<span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">		<span class="keyword">const</span> count = ref(<span class="number">0</span>);</span><br><span class="line">		<span class="comment">// 直接返回一个函数</span></span><br><span class="line">		<span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> h(<span class="string">&quot;div&quot;</span>, &#123; <span class="attr">class</span>: <span class="string">&quot;app&quot;</span> &#125;, [</span><br><span class="line">				h(<span class="string">&quot;h2&quot;</span>, <span class="literal">null</span>, <span class="string">`当前计数：<span class="subst">$&#123;count.value&#125;</span>`</span>),</span><br><span class="line">				h(<span class="string">&quot;button&quot;</span>,&#123;</span><br><span class="line">					<span class="attr">onClick</span>: <span class="function">() =&gt;</span> count.value++,</span><br><span class="line">				&#125;,<span class="string">&quot;+1&quot;</span>),</span><br><span class="line">				h(<span class="string">&quot;button&quot;</span>,&#123;</span><br><span class="line">					<span class="attr">onClick</span>: <span class="function">() =&gt;</span> count.value--,</span><br><span class="line">				&#125;,<span class="string">&quot;-1&quot;</span>),</span><br><span class="line">			]);</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="传递props参数"><a href="#传递props参数" class="headerlink" title="传递props参数"></a>传递props参数</h5><p><strong>父组件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; h &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> h(HelloWorld, &#123; <span class="attr">message</span>: <span class="string">&#x27;hahah&#x27;</span> &#125;, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>子组件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">message</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="built_in">String</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> h(<span class="string">&#x27;h2&#x27;</span>, <span class="literal">null</span>, [</span><br><span class="line">        h(<span class="string">&#x27;p&#x27;</span>, &#123;&#125;, <span class="string">&#x27;hello world!&#x27;</span>),</span><br><span class="line">        h(<span class="string">&#x27;p&#x27;</span>,&#123;&#125;, <span class="built_in">this</span>.message)</span><br><span class="line">    ])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="插槽的使用"><a href="#插槽的使用" class="headerlink" title="插槽的使用"></a>插槽的使用</h5><p><strong>父组件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, h &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> HelloWorld <span class="keyword">from</span> <span class="string">&#x27;./HelloWorld.vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	<span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> h(HelloWorld, <span class="literal">null</span>, &#123;</span><br><span class="line">         <span class="comment">// 插槽名称：接收子组件的参数</span></span><br><span class="line">			<span class="attr">default</span>: <span class="function"><span class="params">props</span> =&gt;</span> h(<span class="string">&#x27;span&#x27;</span>, <span class="literal">null</span>, <span class="string">`接收到子组件传递过来的值：<span class="subst">$&#123;props.name&#125;</span>`</span>)</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>子组件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> h(<span class="string">&#x27;div&#x27;</span>, <span class="literal">null</span>, [</span><br><span class="line">        h(<span class="string">&#x27;h2&#x27;</span>, <span class="literal">null</span>, <span class="string">&#x27;hello world&#x27;</span>),</span><br><span class="line">        <span class="built_in">this</span>.$slots.default ? </span><br><span class="line">        <span class="comment">//                  传递给父组件的参数(作用域插槽)</span></span><br><span class="line">        <span class="built_in">this</span>.$slots.default(&#123;<span class="attr">name</span>: <span class="string">&#x27;TT&#x27;</span>&#125;) : </span><br><span class="line">        h(<span class="string">&#x27;span&#x27;</span>, <span class="literal">null</span>, <span class="string">&#x27;hello world的插槽默认值&#x27;</span>)</span><br><span class="line">    ])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h2><h3 id="部分语法"><a href="#部分语法" class="headerlink" title="部分语法"></a>部分语法</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [a,b,c,d,e]</span><br><span class="line"><span class="keyword">const</span> render = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &#123;<span class="comment">/* 单行注释 */</span>&#125;</span><br><span class="line">        &#123;</span><br><span class="line">        	<span class="comment">// 多行</span></span><br><span class="line">        	<span class="comment">// 注释</span></span><br><span class="line">        &#125;</span><br><span class="line">		&lt;h2&gt; 直接编写html标签 &lt;/h2&gt;</span><br><span class="line">								  &#123;<span class="comment">/* vue3中class、className 都可生效 */</span>&#125;</span><br><span class="line">		&lt;button style=<span class="string">&quot;border-color: red&quot;</span> className=<span class="string">&quot;bgc&quot;</span> onClick=&#123;increment&#125;&gt;+&lt;/button&gt;</span><br><span class="line">		<span class="comment">// 所有的js表达式都写在 &#123;&#125; 里</span></span><br><span class="line">		<span class="comment">// 循环生成元素</span></span><br><span class="line">		&#123;</span><br><span class="line">            arr.map( <span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">key</span>=<span class="string">&#x27;&#123;index&#125;&#x27;</span>&gt;</span>&#123; item &#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="jsx计数器案例"><a href="#jsx计数器案例" class="headerlink" title="jsx计数器案例"></a>jsx计数器案例</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> count = ref(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">const</span> increment = <span class="function">() =&gt;</span> count.value ++;</span><br><span class="line">        <span class="keyword">const</span> decrement = <span class="function">() =&gt;</span> count.value --;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            count,</span><br><span class="line">            increment,</span><br><span class="line">            decrement</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>当前计数: &#123;this.count&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.increment&#125;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.decrement&#125;</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="jsx组件和插槽的使用"><a href="#jsx组件和插槽的使用" class="headerlink" title="jsx组件和插槽的使用"></a>jsx组件和插槽的使用</h3><p><strong>父组件</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> HelloWorld <span class="keyword">from</span> <span class="string">&#x27;HelloWorld.vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">HelloWorld</span>&gt;</span></span></span><br><span class="line"><span class="xml">          &#123; default: props =&gt; <span class="tag">&lt;<span class="name">button</span>&gt;</span>&#123;props.name&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">HelloWorld</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>子组件</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123; this.$slots.default ? </span></span><br><span class="line"><span class="xml">                this.$slots.default(&#123;name: &#x27;TT&#x27;&#125;) :</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>插槽默认值<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color=red></font></p>
<h2 id="组件间通信"><a href="#组件间通信" class="headerlink" title="组件间通信"></a>组件间通信</h2><h3 id="父子组件通信"><a href="#父子组件通信" class="headerlink" title="父子组件通信"></a>父子组件通信</h3><ul>
<li>父组件传递给子组件：<font color="red">通过props属性</font><blockquote>
<p>使用<code>v-bind</code>传递给子组件，子组件使用<code>Props</code>接收</p>
</blockquote>
</li>
<li>子组件传递给父组件<font color="red">通过$emit触发事件</font><blockquote>
<p>需要在子组件中写入一个新的配置项<code>emits</code>接收父组件传递的事件名称</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">child</span> @<span class="attr">increment</span>=<span class="string">&#x27;increment&#x27;</span> @<span class="attr">decrement</span>=<span class="string">&#x27;decrement&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">emits</span>: [ <span class="string">&#x27;increment&#x27;</span>, <span class="string">&#x27;decrement&#x27;</span> ],</span><br><span class="line">    <span class="function"><span class="title">setup</span>(<span class="params">props, &#123; attrs, slots, emit &#125;</span>)</span>&#123;</span><br><span class="line">      <span class="function"><span class="title">addOne</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        emit.increment()</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="title">subOne</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        emit.decrement()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="非父子组件的通信"><a href="#非父子组件的通信" class="headerlink" title="非父子组件的通信"></a>非父子组件的通信</h3><h4 id="provide和inject"><a href="#provide和inject" class="headerlink" title="provide和inject"></a>provide和inject</h4><ul>
<li>Provide/Inject用于非父子组件之间共享数据<ul>
<li>比如有一些<font color="red">深度嵌套的组件，后代组件想要获取祖先组件的部分内容</font></li>
<li>在这种情况下，如果我们仍然将props沿着组件链逐级传递下去，就会常的麻烦</li>
</ul>
</li>
<li>这种情况下，可以使用<strong>Provide 和Inject</strong><ul>
<li>无论层级结构有多深，祖先组件都可以作为其所有后代组件的依赖提供者</li>
<li>父组件有一个 <code>provide</code> 函数来提供数据</li>
<li>子组件有一个 <code>inject</code> 函数来接收这些数据</li>
</ul>
</li>
</ul>
<h5 id="Provide函数"><a href="#Provide函数" class="headerlink" title="Provide函数"></a>Provide函数</h5><ul>
<li>可以通过<code>provide</code>方法定义每个<code>Property</code></li>
<li><code>provide</code>接收两个参数<ul>
<li>key： 提供的属性名称（后代组件接收时的名称）</li>
<li>value：提供的属性值<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; provide &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">let</span> count = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">let</span> info = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;TT&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line">provide(<span class="string">&#x27;counter&#x27;</span>, count)</span><br><span class="line">provide(<span class="string">&#x27;info&#x27;</span>, info)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h5 id="Inject函数"><a href="#Inject函数" class="headerlink" title="Inject函数"></a>Inject函数</h5><ul>
<li>在后代组件 中可以通过<code>inject</code> 来注入需要的属性和对应的值</li>
<li><code>inject</code>可以传入两个参数<ul>
<li>key：要接收的属性的key</li>
<li>defaultValue：默认值（可不传）<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = inject(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> info = inject(<span class="string">&#x27;info&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h5 id="provide-inject-的响应式"><a href="#provide-inject-的响应式" class="headerlink" title="provide/inject 的响应式"></a>provide/inject 的响应式</h5><ul>
<li>为了增加 <code>provide</code> 值和 <code>inject</code> 值之间的响应性，可以在 <code>provide</code> 值时使用 <code>ref</code> 和 <code>reactive</code></li>
<li>未防止后代组件修改值，可在<code>provide</code>传递时使用<code>readonly</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = ref(<span class="string">&#x27;TT&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> info = reactive(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;TT&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">provide(<span class="string">&#x27;name&#x27;</span>, readonly(name))</span><br><span class="line">provide(<span class="string">&#x27;info&#x27;</span>, readonly(info))</span><br></pre></td></tr></table></figure></li>
<li>后代组件需要修改<code>inject</code>接收到的值时，要遵守<strong>单向数据流原则</strong>，可以将修改的方法在祖先组件中定义，在后代组件中调用<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***** 祖先组件 *******/</span></span><br><span class="line">  <span class="keyword">let</span> name = ref(<span class="string">&#x27;TT&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> changeName = <span class="function">() =&gt;</span> &#123; name.value = <span class="string">&#x27;zs&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line">  provide(<span class="string">&#x27;name&#x27;</span>, readonly(name))</span><br><span class="line">  provide(<span class="string">&#x27;changeName&#x27;</span>, changeName)</span><br><span class="line"></span><br><span class="line">  <span class="comment">/***** 后代组件 *******/</span></span><br><span class="line">  <span class="keyword">let</span> changeName = inject(<span class="string">&#x27;changeName&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> emitChangeName = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      changeName()</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="全局事件总线mitt库"><a href="#全局事件总线mitt库" class="headerlink" title="全局事件总线mitt库"></a>全局事件总线mitt库</h4><ul>
<li>Vue3从实例中移除了$on、$off 和$once 方法，所以我们如果希望继续使用全局事件总线，要通过第三方的库<ul>
<li>Vue3官方有推荐一些库，例如<a class="link"   target="_blank" rel="noopener" href="https://github.com/developit/mitt" >mitt<i class="fas fa-external-link-alt"></i></a>或<a class="link"   target="_blank" rel="noopener" href="https://github.com/scottcorgan/tiny-emitter" >tiny-emitter<i class="fas fa-external-link-alt"></i></a></li>
</ul>
</li>
<li>封装一个通信工具库<code>eventbus.js</code>:<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&#x27;mitt&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> emitter = mitt();</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> emitter;</span><br></pre></td></tr></table></figure></li>
<li>使用方式</li>
</ul>
<p><strong>监听</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">&#x27;./eventBus&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 监听单个事件</span></span><br><span class="line">    emitter.on(<span class="string">&#x27;tt&#x27;</span>, <span class="function">(<span class="params">info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;tt event:&#x27;</span>， info)</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听所有事件</span></span><br><span class="line">    emitter.on(<span class="string">&#x27;*&#x27;</span>, <span class="function">(<span class="params">type, e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;* event:&#x27;</span>, type, e)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>触发事件总线</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">&#x27;./eventBus&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> triggerEvent = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      emitter.emit(<span class="string">&#x27;tt&#x27;</span>, &#123; <span class="attr">name</span>: <span class="string">&#x27;tt&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>取消监听</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 取消所有监听</span></span><br><span class="line">emitter.all.clear()</span><br><span class="line"><span class="comment">// 如果只想取消某一个事件的监听，要把on监听的回调函数单独定义，例：</span></span><br><span class="line"><span class="function"><span class="title">watchFoo</span>(<span class="params">data</span>)</span>&#123;&#125;</span><br><span class="line">emitter.on(<span class="string">&#x27;foo&#x27;</span>, watchFoo)</span><br><span class="line">emitter.off(<span class="string">&#x27;foo&#x27;</span>, watchFoo)</span><br></pre></td></tr></table></figure>

        </div>

        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/vue3/">#vue3</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/08/27/sync%E4%BF%AE%E9%A5%B0%E7%AC%A6/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">sync修饰符</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;评论</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'AXgWfc3xaSXSfaxFnA09HaUk-gzGzoHsz',
                    appKey: 'WjqcJ2tAwGTlxo5YDnaqmn7R',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: '😜 尽情吐槽吧~',
                    lang: 'zh-CN,zh-HK,default'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return '博主';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = '那该多好';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2021</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">那该多好</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#composition-API"><span class="nav-number">1.</span> <span class="nav-text">composition API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#setup"><span class="nav-number">1.1.</span> <span class="nav-text">setup</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#setup%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="nav-number">1.1.1.</span> <span class="nav-text">setup函数参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#setup%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">1.1.2.</span> <span class="nav-text">setup函数的返回值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#setup%E4%B8%8D%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8this"><span class="nav-number">1.1.3.</span> <span class="nav-text">setup不可以使用this</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#setup%E4%B8%AD%E4%BD%BF%E7%94%A8ref"><span class="nav-number">1.1.4.</span> <span class="nav-text">setup中使用ref</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reactive-API"><span class="nav-number">1.2.</span> <span class="nav-text">Reactive API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ref-API"><span class="nav-number">1.3.</span> <span class="nav-text">Ref API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#readonly"><span class="nav-number">1.4.</span> <span class="nav-text">readonly</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reactive%E5%88%A4%E6%96%AD%E7%9A%84API"><span class="nav-number">1.5.</span> <span class="nav-text">Reactive判断的API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#toRefs"><span class="nav-number">1.6.</span> <span class="nav-text">toRefs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#toRef"><span class="nav-number">1.7.</span> <span class="nav-text">toRef</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ref%E7%9A%84%E5%85%B6%E4%BB%96API"><span class="nav-number">1.8.</span> <span class="nav-text">ref的其他API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#customRef"><span class="nav-number">1.9.</span> <span class="nav-text">customRef</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#computed"><span class="nav-number">1.10.</span> <span class="nav-text">computed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%A6%E5%90%AC%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8F%98%E5%8C%96"><span class="nav-number">1.11.</span> <span class="nav-text">侦听数据的变化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#watchEffect"><span class="nav-number">1.11.1.</span> <span class="nav-text">watchEffect</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#watchEffect%E7%94%A8%E6%B3%95"><span class="nav-number">1.11.1.1.</span> <span class="nav-text">watchEffect用法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#watchEffect%E7%9A%84%E5%81%9C%E6%AD%A2%E4%BE%A6%E5%90%AC"><span class="nav-number">1.11.1.2.</span> <span class="nav-text">watchEffect的停止侦听</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#watchEffect%E6%B8%85%E9%99%A4%E5%89%AF%E4%BD%9C%E7%94%A8"><span class="nav-number">1.11.1.3.</span> <span class="nav-text">watchEffect清除副作用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#watchEffect%E7%9A%84%E6%89%A7%E8%A1%8C%E6%97%B6%E6%9C%BA"><span class="nav-number">1.11.1.4.</span> <span class="nav-text">watchEffect的执行时机</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B0%83%E6%95%B4watchEffect%E7%9A%84%E6%89%A7%E8%A1%8C%E6%97%B6%E6%9C%BA"><span class="nav-number">1.11.1.5.</span> <span class="nav-text">调整watchEffect的执行时机</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#watch"><span class="nav-number">1.11.2.</span> <span class="nav-text">watch</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#watch%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.11.2.1.</span> <span class="nav-text">watch的使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BE%A6%E5%90%AC%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="nav-number">1.11.2.2.</span> <span class="nav-text">侦听单个数据源</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BE%A6%E5%90%AC%E5%A4%9A%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="nav-number">1.11.2.3.</span> <span class="nav-text">侦听多个数据源</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BE%A6%E5%90%AC%E5%93%8D%E5%BA%94%E5%BC%8F%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.11.2.4.</span> <span class="nav-text">侦听响应式对象</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#watch%E7%9A%84%E9%80%89%E9%A1%B9"><span class="nav-number">1.11.2.5.</span> <span class="nav-text">watch的选项</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90"><span class="nav-number">1.12.</span> <span class="nav-text">生命周期钩子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hook%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.13.</span> <span class="nav-text">hook的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E6%96%87%E4%BB%B6%E7%BB%84%E4%BB%B6-lt-script-setup-gt"><span class="nav-number">1.14.</span> <span class="nav-text">单文件组件&lt;script setup&gt;</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-number">1.14.1.</span> <span class="nav-text">基本用法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F"><span class="nav-number">1.14.2.</span> <span class="nav-text">响应式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%BB%84%E4%BB%B6"><span class="nav-number">1.14.3.</span> <span class="nav-text">使用组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E7%BB%84%E4%BB%B6"><span class="nav-number">1.14.4.</span> <span class="nav-text">动态组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#defineProps-%E5%92%8C-defineEmits"><span class="nav-number">1.14.5.</span> <span class="nav-text">defineProps 和 defineEmits</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#h%E5%87%BD%E6%95%B0"><span class="nav-number">1.14.6.</span> <span class="nav-text">h函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95-1"><span class="nav-number">1.14.6.1.</span> <span class="nav-text">基本用法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8setup%E4%B8%AD%E4%BD%BF%E7%94%A8render"><span class="nav-number">1.14.6.2.</span> <span class="nav-text">在setup中使用render</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%A0%E9%80%92props%E5%8F%82%E6%95%B0"><span class="nav-number">1.14.6.3.</span> <span class="nav-text">传递props参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%92%E6%A7%BD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.14.6.4.</span> <span class="nav-text">插槽的使用</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSX"><span class="nav-number">2.</span> <span class="nav-text">JSX</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%83%A8%E5%88%86%E8%AF%AD%E6%B3%95"><span class="nav-number">2.1.</span> <span class="nav-text">部分语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jsx%E8%AE%A1%E6%95%B0%E5%99%A8%E6%A1%88%E4%BE%8B"><span class="nav-number">2.2.</span> <span class="nav-text">jsx计数器案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jsx%E7%BB%84%E4%BB%B6%E5%92%8C%E6%8F%92%E6%A7%BD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">2.3.</span> <span class="nav-text">jsx组件和插槽的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="nav-number">3.</span> <span class="nav-text">组件间通信</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="nav-number">3.1.</span> <span class="nav-text">父子组件通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="nav-number">3.2.</span> <span class="nav-text">非父子组件的通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#provide%E5%92%8Cinject"><span class="nav-number">3.2.1.</span> <span class="nav-text">provide和inject</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Provide%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.1.1.</span> <span class="nav-text">Provide函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Inject%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.1.2.</span> <span class="nav-text">Inject函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#provide-inject-%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F"><span class="nav-number">3.2.1.3.</span> <span class="nav-text">provide&#x2F;inject 的响应式</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BFmitt%E5%BA%93"><span class="nav-number">3.2.2.</span> <span class="nav-text">全局事件总线mitt库</span></a></li></ol></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>




<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
